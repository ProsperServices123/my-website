<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Book a Service - Prosper's Services</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<!-- Calendar CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<!-- Calendar JS -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<style>
body{
font-family:Poppins, sans-serif;
background:#f5f7fb;
margin:0;
padding:0;
}

.booking-container{
max-width:900px;
margin:50px auto;
background:white;
padding:30px;
border-radius:12px;
box-shadow:0 10px 30px rgba(0,0,0,0.1);
}

h1{
text-align:center;
margin-bottom:25px;
}

.times{
display:grid;
grid-template-columns:repeat(3,1fr);
gap:12px;
margin-bottom:25px;
}

.time{
padding:14px;
border:2px solid #4f6cff;
border-radius:10px;
text-align:center;
cursor:pointer;
transition:0.2s;
}

.time:hover{
background:#4f6cff;
color:white;
}

.time.selected{
background:#4f6cff;
color:white;
}

input{
width:100%;
padding:14px;
margin-top:12px;
border-radius:10px;
border:1px solid #ccc;
font-size:16px;
}

button{
background:#4f6cff;
color:white;
border:none;
cursor:pointer;
padding:14px;
margin-top:15px;
border-radius:10px;
font-size:16px;
}

button:hover{
background:#354edb;
}

#msg{
margin-top:15px;
font-weight:600;
text-align:center;
}
</style>
</head>

<body>

<div class="booking-container">
<h1>Book Your Service</h1>

<h3>Select a Date</h3>
<input id="datePicker" placeholder="Click to select a date" readonly>

<h3>Select a Time</h3>
<div id="times" class="times"></div>

<input id="bookingName" placeholder="Full Name" required>
<input id="bookingPhone" placeholder="Phone Number" required>

<label style="display:block;margin-top:15px;font-weight:600;">
Select Service
</label>

<select id="service" style="width:100%;padding:12px;border-radius:10px;margin-top:8px;border:1px solid #ccc;">
  <option value="">Choose a service...</option>
  <option value="Gardening">Gardening</option>
  <option value="Pressure Cleaning">Pressure Cleaning</option>
  <option value="Gutter Cleaning">Gutter Cleaning</option>
</select>

<button id="book">Confirm Booking</button>
<p id="msg"></p>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBv8Iap6L0Zz8U_0k3tQ-Bkb6KI9vGDbtI",
  authDomain: "prosper-e5c0d.firebaseapp.com",
  projectId: "prosper-e5c0d",
  storageBucket: "prosper-e5c0d.appspot.com",
  messagingSenderId: "745275197601",
  appId: "1:745275197601:web:e2f1f1e86013a382f048e0"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const bookingsRef = collection(db, "bookings");

let selectedDate=null;
let selectedTime=null;

const times=document.getElementById("times");
const msg=document.getElementById("msg");

function loadTimes(){
times.innerHTML="";
const slots=["10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30"];

slots.forEach(t=>{
const div=document.createElement("div");
div.className="time";
div.innerText=t;

div.onclick=()=>{
document.querySelectorAll(".time").forEach(el=>el.classList.remove("selected"));
div.classList.add("selected");
selectedTime=t;
};

times.appendChild(div);
});
}

flatpickr("#datePicker", {
    minDate: "today",
    dateFormat: "Y-m-d",
    disable: [
        function(date) {
            return (date.getDay() !== 0 && date.getDay() !== 6);
        }
    ],
    onChange: function(selectedDates, dateStr) {
        selectedDate = dateStr;
        loadTimes();
    }
});

document.getElementById("book").onclick=async()=>{
const name=document.getElementById("bookingName").value.trim();
const phone=document.getElementById("bookingPhone").value.trim();
const email=document.getElementById("bookingEmail").value.trim();

if(!selectedDate||!selectedTime||!name){
msg.textContent="Please fill all required fields";
return;
}

await addDoc(bookingsRef,{
name,
phone,
email,
date:selectedDate,
time:selectedTime,
created:new Date()
});

msg.textContent="Booking Confirmed!";
};
</script>

</body>
</html>

