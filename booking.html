<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Book a Service - Prosper's Services</title>
<link rel="stylesheet" href="styles.css">

<style>
body{
font-family:Poppins, sans-serif;
background:#f5f7fb;
margin:0;
padding:0;
}

.booking-container{
max-width:900px;
margin:50px auto;
background:white;
padding:30px;
border-radius:12px;
box-shadow:0 10px 30px rgba(0,0,0,0.1);
}

h1{
text-align:center;
margin-bottom:20px;
}

.calendar{
display:grid;
grid-template-columns:repeat(7,1fr);
gap:10px;
margin-bottom:25px;
}

.day{
padding:12px;
background:#eef2ff;
border-radius:8px;
text-align:center;
cursor:pointer;
transition:.2s;
}

.day:hover{
background:#4f6cff;
color:white;
}

.day.selected{
background:#4f6cff;
color:white;
}

.times{
display:grid;
grid-template-columns:repeat(3,1fr);
gap:10px;
margin-bottom:25px;
}

.time{
padding:12px;
border:2px solid #4f6cff;
border-radius:8px;
text-align:center;
cursor:pointer;
}

.time.selected{
background:#4f6cff;
color:white;
}

form input, form button{
width:100%;
padding:12px;
margin-top:10px;
border-radius:8px;
border:1px solid #ccc;
font-size:16px;
}

button{
background:#4f6cff;
color:white;
border:none;
cursor:pointer;
}

button:hover{
background:#354edb;
}
</style>
  <!-- Calendar CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<!-- Calendar JS -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

</head>

<body>

<div class="booking-container">
<h1>Book Your Service</h1>

<h3>Select a Date</h3>
<div id="calendar" class="calendar"></div>

<h3>Select a Time</h3>
<div id="times" class="times"></div>

<input id="bookingName" placeholder="Full Name">
<input id="bookingPhone" placeholder="Phone">
<input id="bookingEmail" placeholder="Email (optional)">
<button id="book">Confirm Booking</button>
<p id="msg"></p>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBv8Iap6L0Zz8U_0k3tQ-Bkb6KI9vGDbtI",
  authDomain: "prosper-e5c0d.firebaseapp.com",
  projectId: "prosper-e5c0d",
  storageBucket: "prosper-e5c0d.appspot.com",
  messagingSenderId: "745275197601",
  appId: "1:745275197601:web:e2f1f1e86013a382f048e0"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const bookingsRef = collection(db, "bookings");

let selectedDate=null;
let selectedTime=null;

const calendar=document.getElementById("calendar");
const times=document.getElementById("times");

/* --- CREATE WEEKEND CALENDAR --- */

const today=new Date();

for(let i=0;i<30;i++){
let d=new Date();
d.setDate(today.getDate()+i);

let day=d.getDay();

if(day===6 || day===0){ // Saturday or Sunday only
const div=document.createElement("div");
div.className="day";
div.innerText=d.toDateString().slice(0,10);

div.onclick=()=>{
document.querySelectorAll(".day").forEach(el=>el.classList.remove("selected"));
div.classList.add("selected");
selectedDate=d.toDateString();
loadTimes();
};

calendar.appendChild(div);
}
}

/* --- TIMES --- */

function loadTimes(){
times.innerHTML="";
const slots=["10:00am","10:30am","11:00am","11:30am","12:00pm","12:30pm","1:00pm","1:30pm","2:00pm","2:30pm"];

slots.forEach(t=>{
const div=document.createElement("div");
div.className="time";
div.innerText=t;

div.onclick=()=>{
document.querySelectorAll(".time").forEach(el=>el.classList.remove("selected"));
div.classList.add("selected");
selectedTime=t;
};

times.appendChild(div);
});
}

/* --- BOOKING SUBMIT --- */

document.getElementById("booking-form").addEventListener("submit", async(e)=>{
e.preventDefault();

if(!selectedDate || !selectedTime){
alert("Please select a date and time");
return;
}

const name=document.getElementById("customerName").value;
const phone=document.getElementById("customerPhone").value;

await addDoc(bookingsRef,{
name,
phone,
date:selectedDate,
time:selectedTime,
created:new Date()
});

alert("Booking Confirmed! I will contact you shortly.");

e.target.reset();
});

</script>

</body>
</html>
